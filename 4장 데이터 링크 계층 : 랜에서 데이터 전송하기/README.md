# 4장 데이터 링크 계층 : 랜에서 데이터 전송하기

## 데이터 링크 계층의 역할과 이더넷
데이터 링크 계층은 네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층으로, 일반적으로 가장 많이 사용되는 규칙이 이더넷(Ethernet)이다. 이더넷은 목적지가 아닌 컴퓨터는 데이터를 무시하도록 하는 규칙이 있으며, 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않는 구조로 되어 있다. 데이터를 보내는 시점을 늦추는 방법으로 가능한데, 이 방법을 CSMA/CD라고 한다. 
* CS: 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지 확인
* MA: 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋음 
* CD: 충돌이 발생하고 있는지를 확인

지금 이 방법은 효율적이지 않아 거의 사용되지 않고 있으며 스위치를 사용해 충돌을 막을 수 있다. 

  이더넷은 다양한 규격으로 분류된다. 
  ex) 1000BASE-T
  * 통신 속도: 1000은 Mbps 단위인 통신 속도다.
  * 전송 방식: BASE는 BASEBAND라는 전송 방식을 나타낸다.
  * 케이블 종류: T는 케이블 종류를 나타낸다. 하이픈 뒤는 케이블 길이나 케이블 종류를 나타내지만, 동축 케이블은 하이픈 없이 케이블의 최대 길이를 100미터 단위로 표시한다. 

## MAC 주소의 구조
Mac주소(Media Access Control Address, 물리주소)는 랜 카드를 제조할 때 정해진다. 중복되지 않게 명확한 규칙이 있기 때문에 전 세계에서 유일한 번호가 할당된다. 랜 카드를 만든 제조사의 번호 24비트와 제조사가 랜 카드에 붙인 일련번호 24비트로 이루어져 있으며 총 48비트 숫자로 구성된다. 

데이터 링크 계층에서 이더넷 헤더와 트레일러를 붙인다.
* 이브넷 헤더는 목적지의 MAC주소 6바이트, 출발지의 MAC주소 6바이트, 유형 2바이트, 총 14바이트로 구성되어 있다. 이더넷 유형은 이더넷으로 전송되는 상위 계층 프로토콜의 종류를 나타내며, 16진수 번호가 들어간다. 
* 트레일러는 FCS(Frame Check Sequence)라고도 하는데, 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용된다. 

특정 컴퓨터가 이더넷 헤더에 데이터의 목적지인 컴퓨터의 MAC주소와 자신의 MAC주소를 넣고 데이터를 전송하면 보내는 측 컴퓨터에서 캡슐화가 일어나고, 데이터 링크 계층에서 데이터에 이더넷 헤더와 트레일러를 추가하여 프레임(이더넷 헤더와 트레일러가 추가된 데이터)을 만들고, 물리 계층에서 전기신호가 네트워크를 통해 전송된다. 

모든 포트로 데이터가 전송되면 목적지 MAC 주소와 같은 컴퓨터만 데이터를 수신하며, 충돌을 막기 위해 CSMA/CD 방식이 사용된다. 

## 스위치의 구조
스위치는 데이터 링크 계층에서 동작하며 '레이어 2 스위치' 또는 '스위칭 허브'라고 불린다. 스위치 내부에는 스위치의 포트 번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC주소가 등록되는 데이터베이스인 MAC주소 테이블이 있다. 컴퓨터에서 MAC주소가 추가된 프레임 데이터가 전송되면 MAC주소 테이블에 등록하는 MAC 주소 학습 기능을 가진 것이 허브와 다른 점이다. 
* 플러딩: MAC주소가 MAC 주소 테이블에 등록되어 있지 않아 송신 포트 이외의 포트에도 데이터가 전송되는 것.
* 필터링: MAC주소가 등록되어 있어 목적지 컴퓨터에만 데이터가 전송되는 것. 불필요한 데이터를 네트워크에 전송하지 않는다는 장점이 있음.
## 데이터가 케이블에서 충돌하지 않는 구조
* 통신방식
	
    - 전이중 통신 방식 : 데이터의 송수신을 동시에 통신하여 데이터를 동시에 전송해도 충돌이 발생하지 않음, 컴퓨터 간을 직접 랜 케이블로 연결하는 방식이 해당
    - 반이중 통신 방식 : 회선 하나로 송신과 수신을 번갈아가면서 통신하여 충돌이 발생할 수 있음, 허브에 연결하는 경우가 해당
    
스위치는 전이중 통신 방식으로 충돌이 일어나지 않으며, 허브를 사용하는 것 보다 효율적이다. 또한 허브는 모든 컴퓨터가 충돌 도메인(충돌이 발생할 때 그 영향이 미치는 범위)이지만 스위치는 충돌 도메인이 좁다는 장점이 있다. 
